<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Moveable Character Game</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet"/>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            background: url("https://raw.githubusercontent.com/m-gunuru/ClientProject/refs/heads/Test/ClientProject/front_end/image0.png") center center / cover no-repeat;
            font-family: "Press Start 2P", monospace;
            overflow: hidden;
        }
        #character {
            position: absolute;
            left: 50vw;
            bottom: 0;
            width: 120px;
            height: auto;
            transition: filter 0.2s;
            z-index: 2;
            user-select: none;
            pointer-events: none;
        }
        #settingsBtn {
            background: #3a4fa0;
            color: white;
            border: 2px solid #fff;
            border-radius: 8px;
            font-size: 1rem;
            font-family: "Press Start 2P", monospace;
            padding: 12px 34px;
            text-shadow: 3px 5px 1px #00000094;
            transition: background 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            position:fixed;
            top:20px;
            right:20px;
            z-index:1000;
            min-width: 100px;
            cursor: pointer;
        }
        #settingsBtn:hover { background: #1d2558; }
        #settingsModal {
            display:none;
            position:fixed;
            top:50%;
            left:50%;
            transform:translate(-50%,-50%);
            background:#3a4fa0;
            border-radius:10px;
            box-shadow:0 2px 8px rgba(0,0,0,0.3);
            z-index:2000;
            padding: 36px 40px 36px 40px;
            color:#fff;
            font-family: "Press Start 2P", monospace;
            min-width: 300px;
        }
        #settingsModal h2 { margin-top:0; }
        #settingsModal input[type="range"]{ width: 160px;}
        #settingsModal .button {
            background: #1d2558;
            color: white;
            border: 2px solid #fff;
            border-radius: 8px;
            font-size: 1rem;
            font-family: "Press Start 2P", monospace;
            padding: 8px 20px;
            margin: 8px 6px 0 0;
            cursor:pointer;
        }
        #settingsModal .button:hover { background: #3a4fa0; }
        @media (max-width: 600px) {
            #character { width: 80px; }
            #settingsModal { min-width: 180px; padding: 18px 8vw 18px 8vw; }
        }
    </style>
</head>
<body>
    <!-- Background music -->
    <audio id="bg-music" preload="auto" loop>
      <source src="Pokemon BW2 Iris Battle Remix.mp3" type="audio/mpeg">
    </audio>
    <!-- Character -->
    <!-- Character -->
<img 
    id="character" 
    src="https://raw.githubusercontent.com/ananya-k-a/ClientProject/refs/heads/main/ClientProject/front_end/output-onlinegiftools.gif" 
    alt="Character" 
/>
    <!-- Settings Button -->
    <button id="settingsBtn">Settings</button>
    <!-- Settings Modal -->
    <div id="settingsModal">
        <h2>Settings</h2>
        <label for="volumeSlider">Volume:</label>
        <input type="range" id="volumeSlider" min="0" max="100" step="1"><span id="volumeValue"></span>%
        <br><br>
        <button id="saveSettingsBtn" class="button">Save</button>
        <button id="closeSettingsBtn" class="button">Close</button>
    </div>
    <script>
    // --- Music & Settings Logic ---
    window.onload = function() {
        // Play music on first user interaction (browser policy)
        let musicStarted = false;
        function tryPlayMusic() {
            if (!musicStarted) {
                document.getElementById('bg-music').play().catch(()=>{});
                musicStarted = true;
            }
        }
        window.addEventListener('keydown', tryPlayMusic, { once: true });
        window.addEventListener('mousedown', tryPlayMusic, { once: true });

        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('gameSettings')) || { volume: 100 };
            document.getElementById('volumeSlider').value = settings.volume;
            document.getElementById('volumeValue').textContent = settings.volume;
            document.getElementById('bg-music').volume = settings.volume / 100;
            return settings;
        }
        function saveSettings() {
            const volume = parseInt(document.getElementById('volumeSlider').value, 10);
            localStorage.setItem('gameSettings', JSON.stringify({ volume }));
            alert('Settings saved!');
        }
        const modal = document.getElementById('settingsModal');
        document.getElementById('settingsBtn').onclick = function() {
            modal.style.display = 'block';
            loadSettings();
        };
        document.getElementById('closeSettingsBtn').onclick = function() {
            modal.style.display = 'none';
        };
        document.getElementById('saveSettingsBtn').onclick = function() {
            saveSettings();
            modal.style.display = 'none';
        };
        document.getElementById('volumeSlider').oninput = function() {
            document.getElementById('volumeValue').textContent = this.value;
            document.getElementById('bg-music').volume = this.value / 100;
        };
        loadSettings();
    };

    // --- Character Movement Logic ---
    const char = document.getElementById('character');
    const charWidth = 120; // px, must match CSS
    let pos = { x: window.innerWidth/2 - charWidth/2, y: 0 }; // x from left, y from bottom
    let velocity = { x: 0, y: 0 };
    let move = { left: false, right: false, up: false, down: false, jump: false };
    let onGround = true;
    const speed = 5;
    const jumpStrength = 17;
    const gravity = 0.9;
    const floor = 0; // y = 0 is the ground

    function updateCharPosition() {
        // Horizontal movement
        velocity.x = 0;
        if (move.left) velocity.x = -speed;
        else if (move.right) velocity.x = speed;

        // Vertical movement (jump and gravity)
        if (move.jump && onGround) {
            velocity.y = jumpStrength;
            onGround = false;
        }
        velocity.y -= gravity;

        pos.x += velocity.x;
        pos.y += velocity.y;

        // Boundaries
        const rightBound = window.innerWidth - charWidth;
        if (pos.x < 0) pos.x = 0;
        if (pos.x > rightBound) pos.x = rightBound;

        // Ground collision
        if (pos.y < floor) {
            pos.y = floor;
            velocity.y = 0;
            onGround = true;
        }

        // Ceiling
        const ceiling = window.innerHeight - 80; // character can't go above window (with margin)
        if (pos.y > ceiling) pos.y = ceiling;

        // Apply position
        char.style.left = pos.x + 'px';
        char.style.bottom = pos.y + 'px';
    }

    function gameLoop() {
        updateCharPosition();
        requestAnimationFrame(gameLoop);
    }
    gameLoop();

    // --- Keyboard Controls ---
    window.addEventListener('keydown', function(e) {
        if (["INPUT", "TEXTAREA"].includes(document.activeElement.tagName)) return;
        switch(e.key.toLowerCase()) {
            case "a": move.left = true; break;
            case "d": move.right = true; break;
            case "w": move.up = true; break; // (optional, not needed for jump, but could be used)
            case "s": move.down = true; break;
            case " ": move.jump = true; break;
        }
    });
    window.addEventListener('keyup', function(e) {
        switch(e.key.toLowerCase()) {
            case "a": move.left = false; break;
            case "d": move.right = false; break;
            case "w": move.up = false; break;
            case "s": move.down = false; break;
            case " ": move.jump = false; break;
        }
    });

    // --- Responsive resize ---
    window.addEventListener('resize', ()=>{
        // Keep character within bounds after resize
        const rightBound = window.innerWidth - charWidth;
        if(pos.x > rightBound) pos.x = rightBound;
        char.style.left = pos.x + "px";
    });
    </script>
</body>
</html>
